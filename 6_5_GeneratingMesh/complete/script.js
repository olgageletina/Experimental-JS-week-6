let scene, camera, renderer, geometry, mesh, canvasElm;
const faces = [{ "a": 0, "b": 36, "c": 17 }, { "a": 17, "b": 36, "c": 18 }, { "a": 18, "b": 37, "c": 36 }, { "a": 37, "b": 18, "c": 19 }, { "a": 19, "b": 37, "c": 20 }, { "a": 37, "b": 20, "c": 38 }, { "a": 20, "b": 38, "c": 21 }, { "a": 21, "b": 38, "c": 39 }, { "a": 21, "b": 39, "c": 27 }, { "a": 21, "b": 27, "c": 22 }, { "a": 22, "b": 27, "c": 42 }, { "a": 42, "b": 22, "c": 43 }, { "a": 22, "b": 43, "c": 23 }, { "a": 43, "b": 23, "c": 44 }, { "a": 23, "b": 44, "c": 24 }, { "a": 24, "b": 44, "c": 25 }, { "a": 44, "b": 25, "c": 45 }, { "a": 25, "b": 45, "c": 26 }, { "a": 26, "b": 45, "c": 16 }, { "a": 16, "b": 45, "c": 15 }, { "a": 45, "b": 15, "c": 46 }, { "a": 15, "b": 46, "c": 14 }, { "a": 14, "b": 46, "c": 13 }, { "a": 13, "b": 46, "c": 12 }, { "a": 12, "b": 46, "c": 35 }, { "a": 35, "b": 46, "c": 30 }, { "a": 46, "b": 30, "c": 47 }, { "a": 30, "b": 47, "c": 29 }, { "a": 29, "b": 47, "c": 28 }, { "a": 47, "b": 28, "c": 42 }, { "a": 28, "b": 42, "c": 27 }, { "a": 27, "b": 39, "c": 28 }, { "a": 28, "b": 40, "c": 39 }, { "a": 28, "b": 40, "c": 29 }, { "a": 29, "b": 40, "c": 30 }, { "a": 40, "b": 30, "c": 41 }, { "a": 30, "b": 41, "c": 31 }, { "a": 31, "b": 41, "c": 4 }, { "a": 4, "b": 41, "c": 3 }, { "a": 3, "b": 41, "c": 2 }, { "a": 2, "b": 41, "c": 1 }, { "a": 41, "b": 1, "c": 36 }, { "a": 1, "b": 36, "c": 0 }, { "a": 31, "b": 30, "c": 32 }, { "a": 32, "b": 30, "c": 33 }, { "a": 33, "b": 30, "c": 34 }, { "a": 34, "b": 30, "c": 35 }, { "a": 4, "b": 31, "c": 5 }, { "a": 5, "b": 31, "c": 6 }, { "a": 31, "b": 6, "c": 32 }, { "a": 6, "b": 32, "c": 7 }, { "a": 32, "b": 7, "c": 33 }, { "a": 7, "b": 33, "c": 8 }, { "a": 8, "b": 33, "c": 9 }, { "a": 9, "b": 34, "c": 10 }, { "a": 33, "b": 9, "c": 34 }, { "a": 34, "b": 10, "c": 35 }, { "a": 10, "b": 35, "c": 11 }, { "a": 11, "b": 35, "c": 12 }];
const vertices = [{ "_x": 294.06783298072116, "_y": 191.29847581234904 }, { "_x": 298.7068115099356, "_y": 223.75316052731336 }, { "_x": 307.63950982329516, "_y": 254.25363690495095 }, { "_x": 315.69984512113723, "_y": 280.5221308589262 }, { "_x": 328.02864618815363, "_y": 310.7769905667537 }, { "_x": 344.64541225480684, "_y": 335.50749199762436 }, { "_x": 364.08397718570603, "_y": 354.91810922844627 }, { "_x": 389.17921108984467, "_y": 374.4993616178547 }, { "_x": 424.6323017641823, "_y": 382.7861655381811 }, { "_x": 458.169376828095, "_y": 368.90143358531304 }, { "_x": 477.7872719856151, "_y": 349.46756560346046 }, { "_x": 493.7062125995219, "_y": 330.38623317255167 }, { "_x": 507.2653648782724, "_y": 303.89324126066913 }, { "_x": 516.857430255109, "_y": 273.67962498543193 }, { "_x": 523.0747653642825, "_y": 246.7765468718202 }, { "_x": 528.105967156406, "_y": 217.63128387907304 }, { "_x": 529.9597801083544, "_y": 185.0207802368946 }, { "_x": 314.9210353571756, "_y": 171.1718265656429 }, { "_x": 328.4546116551608, "_y": 157.96754102287625 }, { "_x": 347.5833151947596, "_y": 154.93934768652855 }, { "_x": 365.5409998702059, "_y": 156.66056142183868 }, { "_x": 381.1823285464086, "_y": 161.31275363167072 }, { "_x": 445.937833979724, "_y": 158.93441176386708 }, { "_x": 461.2266204969611, "_y": 152.65056496741508 }, { "_x": 478.19020320768914, "_y": 148.65176351912206 }, { "_x": 497.48059589207867, "_y": 150.03502654378988 }, { "_x": 510.8147762242512, "_y": 161.14991374114584 }, { "_x": 415.9705645760448, "_y": 204.7600196068196 }, { "_x": 416.821868573732, "_y": 228.5751559683019 }, { "_x": 417.69382370296444, "_y": 251.23337298946473 }, { "_x": 418.69211783227956, "_y": 271.01270333839744 }, { "_x": 400.43308072664684, "_y": 284.6700273880618 }, { "_x": 409.3867360862655, "_y": 287.61111774241743 }, { "_x": 419.7947855298801, "_y": 289.24531132833675 }, { "_x": 430.5301863776309, "_y": 285.9532556410437 }, { "_x": 439.11856446204945, "_y": 283.46454653490184 }, { "_x": 339.58381160426933, "_y": 199.80321590799628 }, { "_x": 350.7107681788099, "_y": 195.4521958334947 }, { "_x": 366.77980339218107, "_y": 195.5591579316378 }, { "_x": 381.6142650154225, "_y": 202.92282132231009 }, { "_x": 369.2249230488687, "_y": 209.2284206801353 }, { "_x": 352.02276462861, "_y": 208.10259597804367 }, { "_x": 447.91229063066305, "_y": 199.5760601040139 }, { "_x": 461.9120054180122, "_y": 190.28853752083145 }, { "_x": 478.6451474845622, "_y": 188.99024814009084 }, { "_x": 489.3075971148792, "_y": 194.2823798173015 }, { "_x": 478.288216771307, "_y": 203.0545899838205 }, { "_x": 461.7190147775655, "_y": 202.7366208375224 }, { "_x": 384.19891954886054, "_y": 329.58808703819227 }, { "_x": 397.298202701518, "_y": 322.7529568676273 }, { "_x": 412.2852062419345, "_y": 316.83117497268097 }, { "_x": 421.5402215851892, "_y": 318.562966971384 }, { "_x": 429.6623705388472, "_y": 315.50961323240494 }, { "_x": 446.6635543223009, "_y": 322.7879770508712 }, { "_x": 461.33514846259476, "_y": 327.9820133196905 }, { "_x": 448.5472185075582, "_y": 340.09931364681086 }, { "_x": 436.6240376907175, "_y": 347.9289968535645 }, { "_x": 422.48376831090525, "_y": 350.90840628954453 }, { "_x": 409.46128863504083, "_y": 348.9761882071425 }, { "_x": 396.0711750076624, "_y": 342.9908917141203 }, { "_x": 386.54999875648514, "_y": 329.8930406618409 }, { "_x": 409.85279904113224, "_y": 327.8849191053492 }, { "_x": 422.166568743198, "_y": 327.0322763221985 }, { "_x": 433.21220487801054, "_y": 327.65634434289314 }, { "_x": 457.0402569495611, "_y": 327.7111435107498 }, { "_x": 434.0150912629673, "_y": 333.1947337422192 }, { "_x": 422.25394704960456, "_y": 335.06509387857056 }, { "_x": 410.06999093449446, "_y": 334.84285761081924 }];
canvasElm = document.getElementById("canvas");


function init(c) {
    scene = new THREE.Scene();

    camera = new THREE.OrthographicCamera(0, canvasElm.width, 0, canvasElm.height, -1, 1);

    renderer = new THREE.WebGLRenderer({ canvas: c, antialias: true, alpha: true });
    renderer.setSize(c.width, c.height);
    renderer.setPixelRatio(window.devicePixelRatio);
}

function createShape() {

    // jaw
    const j = vertices.slice(0, 17);

    // brows
    const bL = vertices.slice(17, 22);
    const bR = vertices.slice(22, 27);

    // nose
    const n = vertices.slice(27, 36);

    // eyes
    const eL = vertices.slice(36, 42);
    const eR = vertices.slice(42, 48);

    // face
    const fP = j.concat(bL, bR, n, eL, eR);

    geometry = new THREE.Geometry();


    for (let i = 0; i < fP.length; i++) {
        let labelDiv = document.createElement('div');
        labelDiv.className = 'label';
        labelDiv.textContent = i.toString();
        labelDiv.style.transform = `translate(${fP[i]._x - 5}px, ${fP[i]._y - 5}px)`;

        geometry.vertices.push(new THREE.Vector3(fP[i]._x, fP[i]._y, 0));

        document.getElementById("labels").appendChild(labelDiv);;
    }

    for (let j = 0; j < faces.length; j++) {
        let face = new THREE.Face3(faces[j].a, faces[j].b, faces[j].c);
        geometry.faces.push(face);
    }


    geometry.computeFaceNormals();
    geometry.computeVertexNormals();

    const material = new THREE.MeshBasicMaterial({ color: 0x898989, side: THREE.DoubleSide, wireframe: true });

    shapeMesh = new THREE.Mesh(geometry, material);

    scene.add(shapeMesh);
    renderer.render(scene, camera);
}

init(canvasElm);
createShape();